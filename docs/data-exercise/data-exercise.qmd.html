<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data Exercise – Shaun van den Hurk’s Data Analysis Portfolio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-df479d6c4d77d0e0dfbcb5361179d7fd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Shaun van den Hurk’s Data Analysis Portfolio</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../aboutme.html"> 
<span class="menu-text">About Me</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-projects" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Projects</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-projects">    
        <li>
    <a class="dropdown-item" href="../starter-analysis-exercise/products/report/starter-analysis-report.html">
 <span class="dropdown-text">Starter Analysis Exercise</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../coding-exercise/coding-exercise.html">
 <span class="dropdown-text">R Coding Exercise</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Shaunvet/ShaunvandenHurk-MADA-portfolio"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data Exercise</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="data-exercise-to-generate-synthetic-data." class="level2">
<h2 class="anchored" data-anchor-id="data-exercise-to-generate-synthetic-data.">Data exercise to generate synthetic data.</h2>
<p>Load the required packages:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We are looking to generate a synthetic dataset that evaluates the relationship between vaccination status and history of disease within and to compare thi between different cattle breeds (beef vs dairy breeds). We are going to generate a dataset with 330 individual animals from the age of 6 months to 3 years. Since females are found in higher numbers in cattle production systems we are generating the dataset with 70% females (30% males). We are looking at vaccination as yes or no without specifying specific diseases or vaccines. We will generate columns for history of respiratory disease and history of diarrheal disease (either yes or no).</p>
<p>We first need to set the seed to that our random generation of variables is repeatable</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will start to generate our dataset as described:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Start by assigning the number of cattle (observations)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">330</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#We will assign ages to the animals between 6 months and 3 years (18 months). Age can only be integers (whole numbers in months)</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">6</span><span class="sc">:</span><span class="dv">36</span>, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#we will assign the sex with 70% as females as mentioned</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>sex <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>), n, <span class="at">replace=</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.3</span>))</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#We will assign the cattle breeds with an equal split using Angus as the beef breed and Holstein as the dairy breed</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>breed <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Angus"</span>, <span class="st">"Holstein"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#We will classify these breeds to help with further interpretation and analysis downstream. This would be particularly helpful if we had multiple different breeds for each category in the dataset. We will use the if else function in R.</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>breed_type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(breed<span class="sc">==</span><span class="st">"Angus"</span>, <span class="st">"Beef"</span>, <span class="st">"Dairy"</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Double check that our breed data worked</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(breed_type)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(breed_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "Beef"  "Beef"  "Beef"  "Dairy" "Dairy" "Dairy" "Dairy" "Beef"  "Dairy"
 [10] "Beef"  "Beef"  "Beef"  "Dairy" "Beef"  "Dairy" "Dairy" "Beef"  "Dairy"
 [19] "Beef"  "Dairy" "Beef"  "Beef"  "Dairy" "Dairy" "Dairy" "Dairy" "Dairy"
 [28] "Dairy" "Dairy" "Dairy" "Beef"  "Beef"  "Beef"  "Dairy" "Beef"  "Beef" 
 [37] "Beef"  "Dairy" "Dairy" "Beef"  "Dairy" "Beef"  "Dairy" "Beef"  "Dairy"
 [46] "Dairy" "Dairy" "Beef"  "Beef"  "Dairy" "Dairy" "Dairy" "Dairy" "Dairy"
 [55] "Beef"  "Beef"  "Dairy" "Beef"  "Dairy" "Beef"  "Beef"  "Beef"  "Beef" 
 [64] "Beef"  "Dairy" "Dairy" "Beef"  "Dairy" "Beef"  "Beef"  "Beef"  "Dairy"
 [73] "Beef"  "Beef"  "Beef"  "Beef"  "Dairy" "Beef"  "Dairy" "Dairy" "Dairy"
 [82] "Beef"  "Beef"  "Beef"  "Dairy" "Dairy" "Beef"  "Dairy" "Beef"  "Dairy"
 [91] "Beef"  "Dairy" "Dairy" "Dairy" "Dairy" "Dairy" "Dairy" "Dairy" "Dairy"
[100] "Beef"  "Beef"  "Dairy" "Beef"  "Beef"  "Dairy" "Beef"  "Beef"  "Dairy"
[109] "Dairy" "Beef"  "Beef"  "Beef"  "Beef"  "Beef"  "Beef"  "Dairy" "Dairy"
[118] "Dairy" "Dairy" "Beef"  "Dairy" "Beef"  "Dairy" "Beef"  "Beef"  "Beef" 
[127] "Dairy" "Dairy" "Dairy" "Beef"  "Beef"  "Dairy" "Dairy" "Beef"  "Beef" 
[136] "Beef"  "Beef"  "Beef"  "Beef"  "Beef"  "Beef"  "Beef"  "Beef"  "Dairy"
[145] "Beef"  "Dairy" "Beef"  "Dairy" "Dairy" "Beef"  "Dairy" "Dairy" "Beef" 
[154] "Beef"  "Dairy" "Dairy" "Beef"  "Dairy" "Beef"  "Dairy" "Dairy" "Dairy"
[163] "Beef"  "Beef"  "Dairy" "Dairy" "Dairy" "Beef"  "Beef"  "Dairy" "Beef" 
[172] "Dairy" "Dairy" "Dairy" "Dairy" "Beef"  "Dairy" "Dairy" "Beef"  "Beef" 
[181] "Dairy" "Dairy" "Beef"  "Beef"  "Beef"  "Beef"  "Beef"  "Beef"  "Beef" 
[190] "Beef"  "Beef"  "Beef"  "Dairy" "Beef"  "Beef"  "Beef"  "Dairy" "Dairy"
[199] "Dairy" "Dairy" "Dairy" "Dairy" "Dairy" "Dairy" "Beef"  "Beef"  "Dairy"
[208] "Dairy" "Beef"  "Dairy" "Beef"  "Beef"  "Beef"  "Beef"  "Beef"  "Beef" 
[217] "Dairy" "Dairy" "Beef"  "Beef"  "Dairy" "Dairy" "Beef"  "Beef"  "Beef" 
[226] "Dairy" "Beef"  "Beef"  "Dairy" "Dairy" "Dairy" "Beef"  "Beef"  "Dairy"
[235] "Dairy" "Dairy" "Beef"  "Beef"  "Dairy" "Dairy" "Beef"  "Beef"  "Beef" 
[244] "Dairy" "Dairy" "Beef"  "Beef"  "Dairy" "Beef"  "Beef"  "Dairy" "Beef" 
[253] "Dairy" "Beef"  "Beef"  "Dairy" "Dairy" "Beef"  "Dairy" "Dairy" "Dairy"
[262] "Dairy" "Dairy" "Dairy" "Dairy" "Beef"  "Beef"  "Dairy" "Beef"  "Dairy"
[271] "Dairy" "Beef"  "Beef"  "Dairy" "Beef"  "Dairy" "Dairy" "Beef"  "Beef" 
[280] "Beef"  "Dairy" "Beef"  "Dairy" "Dairy" "Dairy" "Beef"  "Beef"  "Beef" 
[289] "Beef"  "Beef"  "Beef"  "Beef"  "Dairy" "Dairy" "Dairy" "Beef"  "Beef" 
[298] "Beef"  "Beef"  "Dairy" "Beef"  "Dairy" "Dairy" "Beef"  "Beef"  "Dairy"
[307] "Beef"  "Dairy" "Beef"  "Dairy" "Dairy" "Dairy" "Beef"  "Dairy" "Beef" 
[316] "Beef"  "Dairy" "Dairy" "Dairy" "Beef"  "Dairy" "Beef"  "Dairy" "Beef" 
[325] "Beef"  "Dairy" "Dairy" "Dairy" "Dairy" "Beef" </code></pre>
</div>
</div>
<p>We must now generate the vaccination and disease history data before we can produce our dataframe.</p>
<p>We will make the incidence of respiratory disease slightly higher in beef animals than in dairy animals, and the opposite (slightly higher incidence of diarrheal disease in dairy animals than beef animals).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#We will assign vaccination status (yes/no) randomly</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>vaccination <span class="ot">&lt;-</span> <span class="fu">sample</span> (<span class="fu">c</span>(<span class="st">"Yes"</span>,<span class="st">"No"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Assign history of diseases based on our assumptions</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Start by generating a vector for the history of disease - diarrhea or respiratory</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>history_diarrhea <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"No"</span>, n)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>history_respiratory <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"No"</span>, n)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Using a loop function to change the incidence of the different diseases in beef and dairy breeds as mentioned above</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#I had chatGPT help me to generate the code for this</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (breed[i] <span class="sc">==</span> <span class="st">"Holstein"</span>) {</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> <span class="fl">0.35</span>) history_diarrhea[i] <span class="ot">&lt;-</span> <span class="st">"Yes"</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> <span class="fl">0.25</span>) history_respiratory[i] <span class="ot">&lt;-</span> <span class="st">"Yes"</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> <span class="fl">0.30</span>) history_diarrhea[i] <span class="ot">&lt;-</span> <span class="st">"Yes"</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> <span class="fl">0.35</span>) history_respiratory[i] <span class="ot">&lt;-</span> <span class="st">"Yes"</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co">#We are applying the conditions above if the breed is Holstein and if it is not then we apply the conditions below the else.</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co">#We now want to make sure that animals that are not vaccinated have a higher incidence of disease (vaccination is correlated with freedom from or reduced incidence of disease)</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co">#We will use another loop funciton for this.</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co"># I had ChatGPT assist with this code for the loop</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (vaccination[i] <span class="sc">==</span> <span class="st">"No"</span> <span class="sc">&amp;&amp;</span> history_diarrhea[i] <span class="sc">==</span> <span class="st">"No"</span> <span class="sc">&amp;&amp;</span> history_respiratory[i] <span class="sc">==</span> <span class="st">"No"</span>) {</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> <span class="fl">0.5</span>) {</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>      history_diarrhea[i] <span class="ot">&lt;-</span> <span class="st">"Yes"</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>      history_respiratory[i] <span class="ot">&lt;-</span> <span class="st">"Yes"</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We want to make four different categories that will help us to evaluate the different disease states that are possible. Different states are “Respiratory disease”, “Diarrhea disease”, “Both diseases”, and “No disease”. We will create an additional column for this to make it easier for us to call back to this for later models and plots. This could have been done as a second or separate dataframe without including it in the main datframe if we preferred. For ease it has been done now for less separate steps.</p>
<p>Create disease history classification:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>disease_history <span class="ot">&lt;-</span> <span class="fu">case_when</span>(history_respiratory <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> history_diarrhea <span class="sc">==</span> <span class="st">"No"</span> <span class="sc">~</span> <span class="st">"Respiratory Only"</span>, history_respiratory <span class="sc">==</span> <span class="st">"No"</span> <span class="sc">&amp;</span> history_diarrhea <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="st">"Diarrhea Only"</span>, history_respiratory <span class="sc">==</span> <span class="st">"yes"</span> <span class="sc">&amp;</span> history_diarrhea <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="st">"Both Diseases"</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"No Disease"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then create a dataframe with all of these variables that we have assigned. We will call this cattle_data. We change the font of the column names to help use define searches and functions more directly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>cattle_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Age =</span> age, <span class="at">Sex =</span> sex, <span class="at">Breed =</span> breed, <span class="at">Breed_Type =</span> breed_type, <span class="at">Vaccination =</span> vaccination, <span class="at">History_Diarrhea =</span> history_diarrhea, <span class="at">History_Respiratory =</span> history_respiratory, <span class="at">Disease_History =</span> <span class="fu">factor</span>(disease_history, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"No Disease"</span>, <span class="st">"Respiratory Only"</span>, <span class="st">"Diarrhea Only"</span>, <span class="st">"Both Diseases"</span>)))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cattle_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Age            Sex               Breed            Breed_Type       
 Min.   : 6.00   Length:330         Length:330         Length:330        
 1st Qu.:14.00   Class :character   Class :character   Class :character  
 Median :22.00   Mode  :character   Mode  :character   Mode  :character  
 Mean   :21.84                                                           
 3rd Qu.:30.00                                                           
 Max.   :36.00                                                           
 Vaccination        History_Diarrhea   History_Respiratory
 Length:330         Length:330         Length:330         
 Class :character   Class :character   Class :character   
 Mode  :character   Mode  :character   Mode  :character   
                                                          
                                                          
                                                          
         Disease_History
 No Disease      :111   
 Respiratory Only:102   
 Diarrhea Only   :117   
 Both Diseases   :  0   
                        
                        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cattle_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Age    Sex    Breed Breed_Type Vaccination History_Diarrhea
1    36 Female    Angus       Beef          No              Yes
2    20 Female    Angus       Beef          No               No
3    24 Female    Angus       Beef         Yes              Yes
4    19 Female Holstein      Dairy          No              Yes
5     8 Female Holstein      Dairy         Yes               No
6    15   Male Holstein      Dairy         Yes               No
7    23 Female Holstein      Dairy          No              Yes
8    27 Female    Angus       Beef          No               No
9    16 Female Holstein      Dairy         Yes               No
10   10 Female    Angus       Beef         Yes               No
11   25   Male    Angus       Beef          No              Yes
12   19 Female    Angus       Beef          No              Yes
13   27 Female Holstein      Dairy         Yes               No
14   30 Female    Angus       Beef          No               No
15   31   Male Holstein      Dairy         Yes               No
16   32 Female Holstein      Dairy         Yes              Yes
17   10 Female    Angus       Beef         Yes               No
18   24 Female Holstein      Dairy          No              Yes
19   32   Male    Angus       Beef          No               No
20   30 Female Holstein      Dairy         Yes              Yes
21   33 Female    Angus       Beef         Yes              Yes
22   30   Male    Angus       Beef          No              Yes
23   14 Female Holstein      Dairy         Yes               No
24   34 Female Holstein      Dairy          No               No
25    8   Male Holstein      Dairy          No               No
26   13 Female Holstein      Dairy          No              Yes
27   31 Female Holstein      Dairy         Yes              Yes
28   12 Female Holstein      Dairy         Yes              Yes
29   15 Female Holstein      Dairy         Yes               No
30   14 Female Holstein      Dairy          No              Yes
31   35 Female    Angus       Beef          No               No
32   24   Male    Angus       Beef          No              Yes
33    9 Female    Angus       Beef         Yes               No
34   19 Female Holstein      Dairy          No               No
35   22   Male    Angus       Beef          No              Yes
36   16   Male    Angus       Beef         Yes              Yes
37   12 Female    Angus       Beef         Yes               No
38   26 Female Holstein      Dairy         Yes               No
39   17   Male Holstein      Dairy         Yes               No
40   20 Female    Angus       Beef         Yes               No
41   15   Male Holstein      Dairy         Yes               No
42   18 Female    Angus       Beef         Yes              Yes
43   12   Male Holstein      Dairy          No              Yes
44   14 Female    Angus       Beef          No              Yes
45   14   Male Holstein      Dairy          No              Yes
46   15 Female Holstein      Dairy          No              Yes
47   28 Female Holstein      Dairy          No              Yes
48   32 Female    Angus       Beef         Yes              Yes
49   33 Female    Angus       Beef         Yes               No
50   26   Male Holstein      Dairy          No               No
51   12 Female Holstein      Dairy          No              Yes
52   26   Male Holstein      Dairy          No              Yes
53   32   Male Holstein      Dairy         Yes               No
54   11 Female Holstein      Dairy          No               No
55   30 Female    Angus       Beef         Yes               No
56    7 Female    Angus       Beef          No               No
57   34 Female Holstein      Dairy          No              Yes
58   10 Female    Angus       Beef          No               No
59   13   Male Holstein      Dairy          No              Yes
60   17   Male    Angus       Beef          No              Yes
61   36 Female    Angus       Beef         Yes               No
62   18   Male    Angus       Beef         Yes              Yes
63   23 Female    Angus       Beef         Yes               No
64    6 Female    Angus       Beef          No              Yes
65   30 Female Holstein      Dairy          No              Yes
66   32   Male Holstein      Dairy          No              Yes
67   30 Female    Angus       Beef         Yes              Yes
68   11 Female Holstein      Dairy         Yes               No
69   26 Female    Angus       Beef         Yes              Yes
70   20 Female    Angus       Beef          No               No
71   14   Male    Angus       Beef         Yes              Yes
72   20 Female Holstein      Dairy          No              Yes
73   31 Female    Angus       Beef         Yes               No
74   33 Female    Angus       Beef         Yes               No
75   36 Female    Angus       Beef          No               No
76   21   Male    Angus       Beef          No              Yes
77   25 Female Holstein      Dairy         Yes               No
78   35 Female    Angus       Beef         Yes              Yes
79   11 Female Holstein      Dairy          No               No
80   16 Female Holstein      Dairy          No               No
81   13 Female Holstein      Dairy         Yes              Yes
82   27 Female    Angus       Beef         Yes               No
83   27 Female    Angus       Beef         Yes               No
84   12   Male    Angus       Beef          No              Yes
85   36 Female Holstein      Dairy         Yes               No
86   21 Female Holstein      Dairy         Yes               No
87   22 Female    Angus       Beef         Yes              Yes
88   27 Female Holstein      Dairy         Yes               No
89   23   Male    Angus       Beef          No               No
90   22   Male Holstein      Dairy         Yes               No
91    7 Female    Angus       Beef          No              Yes
92    9 Female Holstein      Dairy         Yes              Yes
93   18   Male Holstein      Dairy          No               No
94   10 Female Holstein      Dairy         Yes               No
95   27 Female Holstein      Dairy          No              Yes
96   36 Female Holstein      Dairy          No              Yes
97   24 Female Holstein      Dairy         Yes               No
98   30 Female Holstein      Dairy          No              Yes
99   25 Female Holstein      Dairy          No               No
100  27 Female    Angus       Beef         Yes              Yes
101  30 Female    Angus       Beef         Yes               No
102  19   Male Holstein      Dairy         Yes               No
103  30 Female    Angus       Beef         Yes              Yes
104  28   Male    Angus       Beef          No              Yes
105   8   Male Holstein      Dairy          No               No
106  13   Male    Angus       Beef         Yes               No
107  21 Female    Angus       Beef         Yes               No
108  35 Female Holstein      Dairy         Yes              Yes
109  17 Female Holstein      Dairy         Yes               No
110  36 Female    Angus       Beef          No              Yes
111  30 Female    Angus       Beef         Yes              Yes
112  19 Female    Angus       Beef          No              Yes
113  35 Female    Angus       Beef          No              Yes
114   8 Female    Angus       Beef          No              Yes
115  19   Male    Angus       Beef         Yes               No
116  34   Male Holstein      Dairy          No              Yes
117  12   Male Holstein      Dairy          No              Yes
118   8 Female Holstein      Dairy          No              Yes
119  28 Female Holstein      Dairy          No               No
120  27   Male    Angus       Beef         Yes               No
121  31 Female Holstein      Dairy          No              Yes
122  20 Female    Angus       Beef         Yes               No
123  26 Female Holstein      Dairy         Yes               No
124  10 Female    Angus       Beef          No               No
125  13 Female    Angus       Beef          No               No
126  24 Female    Angus       Beef         Yes              Yes
127  15 Female Holstein      Dairy         Yes              Yes
128  23 Female Holstein      Dairy         Yes               No
129  15   Male Holstein      Dairy         Yes               No
130  17 Female    Angus       Beef         Yes               No
131   7   Male    Angus       Beef         Yes               No
132  15 Female Holstein      Dairy         Yes               No
133  27   Male Holstein      Dairy          No              Yes
134  36 Female    Angus       Beef          No              Yes
135  17 Female    Angus       Beef         Yes              Yes
136  25 Female    Angus       Beef         Yes              Yes
137  19 Female    Angus       Beef          No              Yes
138  22 Female    Angus       Beef         Yes              Yes
139  35   Male    Angus       Beef         Yes              Yes
140  19 Female    Angus       Beef         Yes               No
141  27   Male    Angus       Beef          No               No
142   8 Female    Angus       Beef         Yes               No
143  13 Female    Angus       Beef          No              Yes
144  19   Male Holstein      Dairy          No              Yes
145  24 Female    Angus       Beef          No              Yes
146  35 Female Holstein      Dairy          No              Yes
147  20 Female    Angus       Beef          No              Yes
148  29 Female Holstein      Dairy          No              Yes
149  22   Male Holstein      Dairy          No              Yes
150  28   Male    Angus       Beef         Yes               No
151  16 Female Holstein      Dairy          No               No
152  12 Female Holstein      Dairy         Yes               No
153  34   Male    Angus       Beef         Yes               No
154  20 Female    Angus       Beef          No              Yes
155  28   Male Holstein      Dairy          No               No
156  31 Female Holstein      Dairy         Yes               No
157  11 Female    Angus       Beef          No               No
158  19 Female Holstein      Dairy         Yes               No
159  36   Male    Angus       Beef         Yes               No
160  12 Female Holstein      Dairy          No              Yes
161  32 Female Holstein      Dairy          No              Yes
162  15 Female Holstein      Dairy         Yes               No
163  10 Female    Angus       Beef          No               No
164  11 Female    Angus       Beef         Yes               No
165  21 Female Holstein      Dairy          No               No
166  29 Female Holstein      Dairy         Yes              Yes
167  26 Female Holstein      Dairy         Yes               No
168  28   Male    Angus       Beef          No               No
169  16 Female    Angus       Beef          No               No
170   9 Female Holstein      Dairy          No              Yes
171  17 Female    Angus       Beef          No               No
172  19   Male Holstein      Dairy          No               No
173  33 Female Holstein      Dairy          No               No
174  34   Male Holstein      Dairy          No              Yes
175  24 Female Holstein      Dairy          No              Yes
176  30 Female    Angus       Beef          No              Yes
177  12   Male Holstein      Dairy          No              Yes
178  27 Female Holstein      Dairy         Yes              Yes
179  31   Male    Angus       Beef         Yes               No
180  14 Female    Angus       Beef         Yes               No
181  12 Female Holstein      Dairy         Yes              Yes
182   7 Female Holstein      Dairy         Yes               No
183  21 Female    Angus       Beef         Yes               No
184  18 Female    Angus       Beef         Yes               No
185  24 Female    Angus       Beef          No              Yes
186  29   Male    Angus       Beef          No              Yes
187  25 Female    Angus       Beef          No               No
188  20   Male    Angus       Beef         Yes               No
189  12 Female    Angus       Beef         Yes               No
190   9   Male    Angus       Beef          No               No
191   6 Female    Angus       Beef          No              Yes
192  13 Female    Angus       Beef         Yes               No
193  35   Male Holstein      Dairy          No               No
194  35 Female    Angus       Beef         Yes               No
195  25   Male    Angus       Beef         Yes              Yes
196  30 Female    Angus       Beef         Yes               No
197  21   Male Holstein      Dairy          No              Yes
198  29 Female Holstein      Dairy         Yes               No
199  27 Female Holstein      Dairy         Yes               No
200  16   Male Holstein      Dairy         Yes              Yes
201  21 Female Holstein      Dairy          No               No
202  25   Male Holstein      Dairy          No               No
203  13 Female Holstein      Dairy         Yes               No
204   8   Male Holstein      Dairy         Yes               No
205  34   Male    Angus       Beef         Yes               No
206   9 Female    Angus       Beef          No               No
207  25   Male Holstein      Dairy         Yes              Yes
208  17   Male Holstein      Dairy         Yes              Yes
209  27 Female    Angus       Beef         Yes               No
210  22 Female Holstein      Dairy         Yes               No
211  15 Female    Angus       Beef         Yes               No
212  32 Female    Angus       Beef          No               No
213  25   Male    Angus       Beef         Yes               No
214  16 Female    Angus       Beef          No              Yes
215  30 Female    Angus       Beef         Yes               No
216  28 Female    Angus       Beef         Yes              Yes
217  13 Female Holstein      Dairy          No              Yes
218  19 Female Holstein      Dairy          No              Yes
219  26 Female    Angus       Beef          No               No
220  18 Female    Angus       Beef          No               No
221   7   Male Holstein      Dairy          No               No
222  16   Male Holstein      Dairy          No               No
223  18 Female    Angus       Beef          No               No
224  19 Female    Angus       Beef         Yes              Yes
225  11 Female    Angus       Beef         Yes               No
226  30 Female Holstein      Dairy          No              Yes
227  13   Male    Angus       Beef          No               No
228  17 Female    Angus       Beef         Yes              Yes
229  31   Male Holstein      Dairy          No               No
230   9 Female Holstein      Dairy          No               No
231  18   Male Holstein      Dairy         Yes              Yes
232  34 Female    Angus       Beef         Yes               No
233  19 Female    Angus       Beef          No              Yes
234  26   Male Holstein      Dairy          No              Yes
235  21   Male Holstein      Dairy          No               No
236  28 Female Holstein      Dairy          No               No
237  34 Female    Angus       Beef          No              Yes
238   6 Female    Angus       Beef          No              Yes
239  13 Female Holstein      Dairy         Yes               No
240  13   Male Holstein      Dairy         Yes               No
241  15   Male    Angus       Beef          No               No
242  30   Male    Angus       Beef          No              Yes
243  13 Female    Angus       Beef          No               No
244  23   Male Holstein      Dairy         Yes               No
245  34 Female Holstein      Dairy          No              Yes
246  26 Female    Angus       Beef         Yes               No
247  14 Female    Angus       Beef         Yes               No
248  12   Male Holstein      Dairy         Yes               No
249  12 Female    Angus       Beef         Yes               No
250  31 Female    Angus       Beef          No              Yes
251  34 Female Holstein      Dairy         Yes               No
252  33   Male    Angus       Beef         Yes              Yes
253  15 Female Holstein      Dairy          No              Yes
254  29 Female    Angus       Beef         Yes               No
255  36   Male    Angus       Beef         Yes               No
256  27 Female Holstein      Dairy         Yes               No
257  28 Female Holstein      Dairy         Yes               No
258  31   Male    Angus       Beef         Yes              Yes
259  16 Female Holstein      Dairy         Yes              Yes
260   6 Female Holstein      Dairy         Yes              Yes
261  30 Female Holstein      Dairy          No               No
262  34 Female Holstein      Dairy          No              Yes
263  34 Female Holstein      Dairy         Yes               No
264  24 Female Holstein      Dairy         Yes              Yes
265  15   Male Holstein      Dairy         Yes               No
266  26 Female    Angus       Beef         Yes               No
267  27   Male    Angus       Beef         Yes               No
268  18 Female Holstein      Dairy         Yes              Yes
269  16 Female    Angus       Beef          No              Yes
270  16 Female Holstein      Dairy         Yes               No
271  30 Female Holstein      Dairy         Yes               No
272  25 Female    Angus       Beef         Yes               No
273  31   Male    Angus       Beef          No               No
274  12 Female Holstein      Dairy          No              Yes
275  30   Male    Angus       Beef          No               No
276  28   Male Holstein      Dairy         Yes              Yes
277  31   Male Holstein      Dairy          No              Yes
278  25   Male    Angus       Beef          No               No
279  34 Female    Angus       Beef         Yes               No
280  29   Male    Angus       Beef         Yes               No
281  30   Male Holstein      Dairy          No               No
282  14   Male    Angus       Beef          No               No
283  14 Female Holstein      Dairy          No              Yes
284  10 Female Holstein      Dairy          No               No
285  28 Female Holstein      Dairy          No               No
286  19 Female    Angus       Beef          No              Yes
287  19   Male    Angus       Beef          No               No
288  11 Female    Angus       Beef          No               No
289  32 Female    Angus       Beef         Yes               No
290   6   Male    Angus       Beef         Yes               No
291  31   Male    Angus       Beef          No              Yes
292  15 Female    Angus       Beef         Yes               No
293  22   Male Holstein      Dairy          No              Yes
294  31 Female Holstein      Dairy         Yes               No
295  22 Female Holstein      Dairy         Yes              Yes
296  34   Male    Angus       Beef          No              Yes
297  31   Male    Angus       Beef          No              Yes
298  32   Male    Angus       Beef         Yes               No
299  26 Female    Angus       Beef          No              Yes
300  12 Female Holstein      Dairy         Yes               No
301  33   Male    Angus       Beef         Yes               No
302  26   Male Holstein      Dairy          No              Yes
303  31 Female Holstein      Dairy          No              Yes
304  14 Female    Angus       Beef          No               No
305  25 Female    Angus       Beef          No              Yes
306  11   Male Holstein      Dairy          No              Yes
307  23 Female    Angus       Beef          No               No
308  35 Female Holstein      Dairy         Yes               No
309  36 Female    Angus       Beef         Yes               No
310  34   Male Holstein      Dairy          No              Yes
311  22   Male Holstein      Dairy         Yes               No
312  10 Female Holstein      Dairy         Yes              Yes
313  30 Female    Angus       Beef          No               No
314  25   Male Holstein      Dairy         Yes               No
315   8   Male    Angus       Beef         Yes              Yes
316  30   Male    Angus       Beef          No              Yes
317  19 Female Holstein      Dairy         Yes              Yes
318   6 Female Holstein      Dairy         Yes               No
319   7 Female Holstein      Dairy          No              Yes
320   9   Male    Angus       Beef          No               No
321  15   Male Holstein      Dairy         Yes               No
322   6 Female    Angus       Beef          No               No
323  10   Male Holstein      Dairy          No               No
324  26 Female    Angus       Beef          No              Yes
325  30 Female    Angus       Beef         Yes              Yes
326  13   Male Holstein      Dairy          No               No
327  28 Female Holstein      Dairy          No              Yes
328  30 Female Holstein      Dairy          No              Yes
329  26 Female Holstein      Dairy          No               No
330  18 Female    Angus       Beef         Yes              Yes
    History_Respiratory  Disease_History
1                    No    Diarrhea Only
2                   Yes Respiratory Only
3                    No    Diarrhea Only
4                    No    Diarrhea Only
5                    No       No Disease
6                    No       No Disease
7                    No    Diarrhea Only
8                   Yes Respiratory Only
9                    No       No Disease
10                  Yes Respiratory Only
11                  Yes       No Disease
12                  Yes       No Disease
13                  Yes Respiratory Only
14                  Yes Respiratory Only
15                   No       No Disease
16                   No    Diarrhea Only
17                  Yes Respiratory Only
18                  Yes       No Disease
19                  Yes Respiratory Only
20                   No    Diarrhea Only
21                   No    Diarrhea Only
22                   No    Diarrhea Only
23                   No       No Disease
24                  Yes Respiratory Only
25                  Yes Respiratory Only
26                   No    Diarrhea Only
27                   No    Diarrhea Only
28                  Yes       No Disease
29                  Yes Respiratory Only
30                   No    Diarrhea Only
31                  Yes Respiratory Only
32                   No    Diarrhea Only
33                   No       No Disease
34                  Yes Respiratory Only
35                  Yes       No Disease
36                  Yes       No Disease
37                  Yes Respiratory Only
38                   No       No Disease
39                  Yes Respiratory Only
40                   No       No Disease
41                   No       No Disease
42                  Yes       No Disease
43                   No    Diarrhea Only
44                   No    Diarrhea Only
45                   No    Diarrhea Only
46                   No    Diarrhea Only
47                   No    Diarrhea Only
48                   No    Diarrhea Only
49                   No       No Disease
50                  Yes Respiratory Only
51                   No    Diarrhea Only
52                   No    Diarrhea Only
53                   No       No Disease
54                  Yes Respiratory Only
55                  Yes Respiratory Only
56                  Yes Respiratory Only
57                   No    Diarrhea Only
58                  Yes Respiratory Only
59                   No    Diarrhea Only
60                   No    Diarrhea Only
61                   No       No Disease
62                   No    Diarrhea Only
63                  Yes Respiratory Only
64                   No    Diarrhea Only
65                   No    Diarrhea Only
66                   No    Diarrhea Only
67                  Yes       No Disease
68                   No       No Disease
69                   No    Diarrhea Only
70                  Yes Respiratory Only
71                   No    Diarrhea Only
72                   No    Diarrhea Only
73                   No       No Disease
74                   No       No Disease
75                  Yes Respiratory Only
76                   No    Diarrhea Only
77                   No       No Disease
78                   No    Diarrhea Only
79                  Yes Respiratory Only
80                  Yes Respiratory Only
81                   No    Diarrhea Only
82                  Yes Respiratory Only
83                   No       No Disease
84                   No    Diarrhea Only
85                   No       No Disease
86                   No       No Disease
87                   No    Diarrhea Only
88                   No       No Disease
89                  Yes Respiratory Only
90                   No       No Disease
91                   No    Diarrhea Only
92                   No    Diarrhea Only
93                  Yes Respiratory Only
94                   No       No Disease
95                   No    Diarrhea Only
96                   No    Diarrhea Only
97                   No       No Disease
98                  Yes       No Disease
99                  Yes Respiratory Only
100                  No    Diarrhea Only
101                  No       No Disease
102                  No       No Disease
103                  No    Diarrhea Only
104                  No    Diarrhea Only
105                 Yes Respiratory Only
106                 Yes Respiratory Only
107                  No       No Disease
108                 Yes       No Disease
109                  No       No Disease
110                  No    Diarrhea Only
111                  No    Diarrhea Only
112                  No    Diarrhea Only
113                  No    Diarrhea Only
114                  No    Diarrhea Only
115                  No       No Disease
116                  No    Diarrhea Only
117                  No    Diarrhea Only
118                 Yes       No Disease
119                 Yes Respiratory Only
120                 Yes Respiratory Only
121                  No    Diarrhea Only
122                 Yes Respiratory Only
123                 Yes Respiratory Only
124                 Yes Respiratory Only
125                 Yes Respiratory Only
126                 Yes       No Disease
127                  No    Diarrhea Only
128                  No       No Disease
129                  No       No Disease
130                  No       No Disease
131                  No       No Disease
132                  No       No Disease
133                  No    Diarrhea Only
134                  No    Diarrhea Only
135                  No    Diarrhea Only
136                 Yes       No Disease
137                  No    Diarrhea Only
138                  No    Diarrhea Only
139                  No    Diarrhea Only
140                  No       No Disease
141                 Yes Respiratory Only
142                  No       No Disease
143                  No    Diarrhea Only
144                  No    Diarrhea Only
145                 Yes       No Disease
146                 Yes       No Disease
147                  No    Diarrhea Only
148                  No    Diarrhea Only
149                  No    Diarrhea Only
150                  No       No Disease
151                 Yes Respiratory Only
152                  No       No Disease
153                 Yes Respiratory Only
154                 Yes       No Disease
155                 Yes Respiratory Only
156                  No       No Disease
157                 Yes Respiratory Only
158                  No       No Disease
159                  No       No Disease
160                  No    Diarrhea Only
161                  No    Diarrhea Only
162                 Yes Respiratory Only
163                 Yes Respiratory Only
164                 Yes Respiratory Only
165                 Yes Respiratory Only
166                  No    Diarrhea Only
167                  No       No Disease
168                 Yes Respiratory Only
169                 Yes Respiratory Only
170                  No    Diarrhea Only
171                 Yes Respiratory Only
172                 Yes Respiratory Only
173                 Yes Respiratory Only
174                  No    Diarrhea Only
175                 Yes       No Disease
176                  No    Diarrhea Only
177                  No    Diarrhea Only
178                  No    Diarrhea Only
179                  No       No Disease
180                  No       No Disease
181                  No    Diarrhea Only
182                  No       No Disease
183                  No       No Disease
184                  No       No Disease
185                  No    Diarrhea Only
186                  No    Diarrhea Only
187                 Yes Respiratory Only
188                 Yes Respiratory Only
189                  No       No Disease
190                 Yes Respiratory Only
191                 Yes       No Disease
192                  No       No Disease
193                 Yes Respiratory Only
194                  No       No Disease
195                  No    Diarrhea Only
196                  No       No Disease
197                 Yes       No Disease
198                 Yes Respiratory Only
199                  No       No Disease
200                  No    Diarrhea Only
201                 Yes Respiratory Only
202                 Yes Respiratory Only
203                  No       No Disease
204                  No       No Disease
205                 Yes Respiratory Only
206                 Yes Respiratory Only
207                 Yes       No Disease
208                  No    Diarrhea Only
209                  No       No Disease
210                  No       No Disease
211                  No       No Disease
212                 Yes Respiratory Only
213                  No       No Disease
214                  No    Diarrhea Only
215                  No       No Disease
216                 Yes       No Disease
217                  No    Diarrhea Only
218                  No    Diarrhea Only
219                 Yes Respiratory Only
220                 Yes Respiratory Only
221                 Yes Respiratory Only
222                 Yes Respiratory Only
223                 Yes Respiratory Only
224                  No    Diarrhea Only
225                 Yes Respiratory Only
226                  No    Diarrhea Only
227                 Yes Respiratory Only
228                  No    Diarrhea Only
229                 Yes Respiratory Only
230                 Yes Respiratory Only
231                  No    Diarrhea Only
232                  No       No Disease
233                  No    Diarrhea Only
234                  No    Diarrhea Only
235                 Yes Respiratory Only
236                 Yes Respiratory Only
237                  No    Diarrhea Only
238                  No    Diarrhea Only
239                  No       No Disease
240                  No       No Disease
241                 Yes Respiratory Only
242                  No    Diarrhea Only
243                 Yes Respiratory Only
244                  No       No Disease
245                  No    Diarrhea Only
246                 Yes Respiratory Only
247                  No       No Disease
248                 Yes Respiratory Only
249                  No       No Disease
250                  No    Diarrhea Only
251                  No       No Disease
252                 Yes       No Disease
253                  No    Diarrhea Only
254                  No       No Disease
255                 Yes Respiratory Only
256                  No       No Disease
257                  No       No Disease
258                  No    Diarrhea Only
259                  No    Diarrhea Only
260                  No    Diarrhea Only
261                 Yes Respiratory Only
262                  No    Diarrhea Only
263                  No       No Disease
264                  No    Diarrhea Only
265                  No       No Disease
266                 Yes Respiratory Only
267                  No       No Disease
268                  No    Diarrhea Only
269                  No    Diarrhea Only
270                  No       No Disease
271                 Yes Respiratory Only
272                 Yes Respiratory Only
273                 Yes Respiratory Only
274                  No    Diarrhea Only
275                 Yes Respiratory Only
276                  No    Diarrhea Only
277                 Yes       No Disease
278                 Yes Respiratory Only
279                 Yes Respiratory Only
280                  No       No Disease
281                 Yes Respiratory Only
282                 Yes Respiratory Only
283                  No    Diarrhea Only
284                 Yes Respiratory Only
285                 Yes Respiratory Only
286                 Yes       No Disease
287                 Yes Respiratory Only
288                 Yes Respiratory Only
289                  No       No Disease
290                 Yes Respiratory Only
291                  No    Diarrhea Only
292                  No       No Disease
293                 Yes       No Disease
294                  No       No Disease
295                  No    Diarrhea Only
296                  No    Diarrhea Only
297                  No    Diarrhea Only
298                  No       No Disease
299                  No    Diarrhea Only
300                  No       No Disease
301                 Yes Respiratory Only
302                 Yes       No Disease
303                  No    Diarrhea Only
304                 Yes Respiratory Only
305                  No    Diarrhea Only
306                 Yes       No Disease
307                 Yes Respiratory Only
308                 Yes Respiratory Only
309                  No       No Disease
310                 Yes       No Disease
311                 Yes Respiratory Only
312                  No    Diarrhea Only
313                 Yes Respiratory Only
314                  No       No Disease
315                  No    Diarrhea Only
316                 Yes       No Disease
317                  No    Diarrhea Only
318                  No       No Disease
319                  No    Diarrhea Only
320                 Yes Respiratory Only
321                  No       No Disease
322                 Yes Respiratory Only
323                 Yes Respiratory Only
324                  No    Diarrhea Only
325                  No    Diarrhea Only
326                 Yes Respiratory Only
327                  No    Diarrhea Only
328                  No    Diarrhea Only
329                 Yes Respiratory Only
330                  No    Diarrhea Only</code></pre>
</div>
</div>
<p>We want to changed the categorical variables (most of our variables) to factors</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>cattle_data<span class="sc">$</span>Vaccination <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(cattle_data<span class="sc">$</span>Vaccination)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>cattle_data<span class="sc">$</span>History_Diarrhea <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(cattle_data<span class="sc">$</span>History_Diarrhea)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>cattle_data<span class="sc">$</span>History_Respiratory <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(cattle_data<span class="sc">$</span>History_Respiratory)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>cattle_data<span class="sc">$</span>Breed <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(cattle_data<span class="sc">$</span>Breed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will now use logistic regression models to evaluate our data and hopefully see the patterns that we expect. We will also produce some plots to evaluate the data.</p>
<p>First model: geometric logistic regression to test the association between vaccination and disease history (our main association of interest)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Vaccination <span class="sc">~</span> Disease_History <span class="sc">+</span> Breed, <span class="at">data =</span> cattle_data, <span class="at">family =</span> binomial)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Vaccination ~ Disease_History + Breed, family = binomial, 
    data = cattle_data)

Coefficients:
                                Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                       1.7733     0.2925   6.062 1.35e-09 ***
Disease_HistoryRespiratory Only  -2.4618     0.3363  -7.321 2.47e-13 ***
Disease_HistoryDiarrhea Only     -2.2069     0.3193  -6.911 4.82e-12 ***
BreedHolstein                    -0.3552     0.2543  -1.397    0.162    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 457.47  on 329  degrees of freedom
Residual deviance: 376.50  on 326  degrees of freedom
AIC: 384.5

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p>From the results of this model we can see that the absence of vaccination is strongly and statistically associated with the presence of both respiratory and diarrheal disease in caatle in the dataset. However there is not a statistically significant association/effect between breed and vaccination.</p>
<p>Second model: geometric logistic regression to test the effect of breed on respiratory disease (we expect beef breeds to have a higher incidence than dairy)</p>
<p>Logistic regression testing the effect of breed on disease history. We would need to use a multinomial regression here if we want to test disease history with both respiratory and diarrheal disease in the same model, so instead we will evaluate diarrheal disease and respiratory disease separately using binomial models.</p>
<p>Second model: Geometric logistic regression testing the effect of breed on respiratory disease history (we expect respiratory disease to be slightly higher in beef breeds).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(History_Respiratory <span class="sc">~</span> Breed <span class="sc">+</span> Age, <span class="at">data =</span> cattle_data, <span class="at">family =</span> binomial)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = History_Respiratory ~ Breed + Age, family = binomial, 
    data = cattle_data)

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)    0.08072    0.33356   0.242   0.8088  
BreedHolstein -0.44122    0.22784  -1.937   0.0528 .
Age           -0.01319    0.01319  -1.000   0.3172  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 443.36  on 329  degrees of freedom
Residual deviance: 438.85  on 327  degrees of freedom
AIC: 444.85

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p>Third model: geometric logistic regression to test the effect of breed on diarrhea disease (we expect dairy breeds to have a higher incidence than beef)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(History_Diarrhea <span class="sc">~</span> Breed <span class="sc">+</span> Age, <span class="at">data =</span> cattle_data, <span class="at">family =</span> binomial)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = History_Diarrhea ~ Breed + Age, family = binomial, 
    data = cattle_data)

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)   -0.79869    0.33562  -2.380   0.0173 *
BreedHolstein  0.24110    0.22365   1.078   0.2810  
Age            0.02044    0.01304   1.568   0.1169  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 453.09  on 329  degrees of freedom
Residual deviance: 449.69  on 327  degrees of freedom
AIC: 455.69

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p>Fourth model: linear logistic regression to test age differences across vaccination status (we do not expect correlation in our dataset)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>model4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Age <span class="sc">~</span> Vaccination, <span class="at">data =</span> cattle_data)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Age ~ Vaccination, data = cattle_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.1402  -7.5482   0.1558   7.8598  14.4518 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     21.5482     0.6701  32.155   &lt;2e-16 ***
VaccinationYes   0.5921     0.9506   0.623    0.534    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.634 on 328 degrees of freedom
Multiple R-squared:  0.001181,  Adjusted R-squared:  -0.001864 
F-statistic: 0.3879 on 1 and 328 DF,  p-value: 0.5338</code></pre>
</div>
</div>
<p>Fifth model: linear logistic regression to test age differences across disease history (we do not expect correlation in our dataset)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>model5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Age <span class="sc">~</span> Disease_History, <span class="at">data =</span> cattle_data)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Age ~ Disease_History, data = cattle_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.4615  -7.4615   0.2255   7.5385  15.2255 

Coefficients:
                                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                      22.1712     0.8183  27.093   &lt;2e-16 ***
Disease_HistoryRespiratory Only  -1.3967     1.1825  -1.181    0.238    
Disease_HistoryDiarrhea Only      0.2904     1.1424   0.254    0.800    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.622 on 327 degrees of freedom
Multiple R-squared:  0.007074,  Adjusted R-squared:  0.001001 
F-statistic: 1.165 on 2 and 327 DF,  p-value: 0.3133</code></pre>
</div>
</div>
<p>Plotting our graphs to see how they compare with our associations seen in the linear regression models</p>
<p>First plot: Violin plot to compare disease history with the vaccination status per breed</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cattle_data, <span class="fu">aes</span>(<span class="at">x =</span> Disease_History, <span class="at">y =</span> Vaccination, <span class="at">fill =</span> Breed)) <span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Disease History"</span>, <span class="at">y =</span> <span class="st">"Vaccination Status"</span>, <span class="at">fill =</span> <span class="st">"Breed"</span>) <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data-exercise.qmd_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This violin plot doesn’t really display this data well. We will produce a bar plot instead.</p>
<p>Generate a bar plot to evaluate the relationship between vaccination status and disease history by comparing the proportions of animals with history of disease and vaccination status. We are working with proportion instead of count to make interpretation easier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cattle_data, <span class="fu">aes</span>(<span class="at">x =</span> Disease_History, <span class="at">fill =</span> Vaccination)) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span>  </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Disease History"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>, <span class="at">fill =</span> <span class="st">"Vaccination Status"</span>) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data-exercise.qmd_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Third plot: Scatter plot of age vs vaccination status</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cattle_data, <span class="fu">aes</span>(<span class="at">x =</span> Vaccination, <span class="at">y =</span> Age, <span class="at">color =</span> Vaccination)) <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Vaccination Status"</span>, <span class="at">y =</span> <span class="st">"Age (Months)"</span>) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data-exercise.qmd_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Vaccination status does not show any obvious relationship with age.</p>
<p>Fourth plot: Scatter plot of age vs History of infection (respiratory and diarrheal)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cattle_data, <span class="fu">aes</span>(<span class="at">x =</span> Disease_History, <span class="at">y =</span> Age, <span class="at">color =</span> Disease_History)) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"History of Disease"</span>, <span class="at">y =</span> <span class="st">"Age (Months)"</span>, <span class="at">color =</span> <span class="st">"Disease History"</span>) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data-exercise.qmd_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Fifth plot: Bar plot comparing disease history across all breeds</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cattle_data, <span class="fu">aes</span>(<span class="at">x =</span> Breed, <span class="at">fill =</span> Disease_History)) <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Breed"</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"History of Disease"</span>) <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data-exercise.qmd_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the graphs we once again see that there is no obvious relationship between disease status and age (as we created in the synthetic data, which might differ from real life evaluations). We do see that there is slightly higher incidence of respiratory disease in beef animals, and diarrhea disease in dairy animals.</p>
<p>In summary, our models used for evalaution work well and we produce the expected results from this synthetic dataset. There are some aspects of the synthetic dataset that could be worked on further to make it more closely resemble and model a real-world situation, and then we might need more evaluation. However, as a proof of concept this is helpful at this stage.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>